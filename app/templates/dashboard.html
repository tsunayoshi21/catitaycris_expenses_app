{% extends 'base.html' %}
{% block title %}Dashboard - Finanzas{% endblock %}

{% block head %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    /* Igualar tamaño/altura de gráficos y mejorar estética */
    .chart-container { position: relative; height: 360px; }
    @media (min-width: 1400px){ .chart-container { height: 420px; } }
  </style>
{% endblock %}

{% block content %}
  {% include 'partials/filters.html' %}

  <!-- Resumen -->
  <div class="row g-3 mb-4">
    <div class="col-12 col-md-4 offset-md-4">
      <div class="card shadow-sm">
        <div class="card-body text-center">
          <h5 class="card-title">Gasto total</h5>
          <div id="total" class="display-6">$0</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Gráficos alineados y del mismo tamaño -->
  <div class="row g-3 mb-4 align-items-stretch">
    <div class="col-12 col-xl-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Gasto por categoría (barras)</h5>
          <div class="chart-container">
            <canvas id="catChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-xl-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Distribución por categoría (torta)</h5>
          <div class="chart-container">
            <canvas id="pieChart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Leyenda a ancho completo -->
  <div class="row g-3 mb-4">
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Leyenda</h5>
          <div id="legend" class="d-flex flex-column gap-2"></div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/filters.js') }}" defer></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}" defer></script>
{% endblock %}
